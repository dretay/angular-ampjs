!function(){define("ngAmpjsModule",["angular"],function(e){return e.module("ngAmpjs",[])}),define("p/shortBus",["shortBus","ngAmpjsModule"],function(e,t){return t.provider("shortBus",function(){return{$get:function(){return e.getBus(this)}}})}),define("util/_deep",["underscore"],function(e){e.mixin({deep:function(t,n,r){var u,o=n.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").split("."),i=0,s=o.length;if(arguments.length>2){for(u=t,s--;s>i;)n=o[i++],t=t[n]=e.isObject(t[n])?t[n]:{};t[o[i]]=r,r=u}else{for(;null!=(t=t[o[i++]])&&s>i;);r=s>i?void 0:t}return r}})}),define("r/AmpEntity",["jquery","underscore","util/_deep"],function(e,t){var n;return n=function(){function n(e,t,n){var r,u;for(r in e)u=e[r],this[r]=u;this.getScope=function(){return n},this.getMessageBus=function(){return t}}return n.prototype._sendRpcMessage=function(n,r){var u,o;return null==r&&(r={}),o=t.isFunction(this.getScope()[n].outboundTransform)?this.getScope()[n].outboundTransform(this,r):this,u=this.getMessageBus().getResponseTo({request:o,timeout:1e4,outboundTopic:this.getScope()[n].outbound,inboundTopic:this.getScope()[n].inbound}),t.isFunction(this.getScope()[n].inboundTransform)&&(u=u.then(e.proxy(this.getScope()[n].inboundTransform,this.getScope()))),u},n.prototype._sendPubSubMessage=function(n,r){var u,o,i,s=this;return null==r&&(r={}),o=t.isFunction(this.getScope()[n].outboundTransform)?this.getScope()[n].outboundTransform(this,r):this,u=e.Deferred(),t.isString(this.getScope()[n].inbound)&&(i=this.getMessageBus().subscribe({getEventType:function(){return s.getScope()[n].inbound},handle:function(r){return u.resolve(r),t.isFunction(s.getScope()[n].inboundTransform)?u=u.then(e.proxy(s.getScope()[n].inboundTransform,s.getScope())):void 0},handleFailed:function(){return console.log("AmpEntity:_sendPubSubMessage>> failure received")}})),this.getMessageBus().publish(o,this.getScope()[n].outbound),u.promise()},n.prototype._messagingPicker=function(e,n){return"PUBSUB"===t.deep(this.getScope(),""+e+".type")?this._sendPubSubMessage(e,n):this._sendRpcMessage(e,n)},n.prototype.save=function(e){return null==e&&(e={}),this._messagingPicker("save",e)},n.prototype["delete"]=function(e){return null==e&&(e={}),this._messagingPicker("delete",e)},n.prototype.update=function(e){return null==e&&(e={}),this._messagingPicker("update",e)},n}()}),define("r/AmpResource",["angular","underscore","./AmpEntity","jquery","ngAmpjsModule","util/_deep","p/shortBus"],function(e,t,n,r,u){return u.factory("ampResource",["$rootScope","shortBus",function(u,o){var i;return i=function(){function i(e){null==e&&(e={}),this.get=e.get,this.save=e.save,this["delete"]=e["delete"],this.update=e.update,this.queryIsArray=e.queryIsArray,this.type=e.type}return i.prototype.queryIsArray=!0,i.prototype.type="RPC",i.prototype._pubSubQuery=function(i,s){var p,c,g,d=this;return null==i&&(i={}),null==s&&(s=!0),p=s?[]:{},t.isString(this.get.inbound)&&(g=o.subscribe({getEventType:function(){return d.get.inbound},handle:function(i){var s,c,g;return c=r.Deferred().resolve(i),t.isFunction(d.get.inboundTransform)&&(c=c.then(d.get.inboundTransform)),s=function(e){return t.isArray(e)?t.map(e,function(e){return new n(e,o,d)}):new n(e,o,d)},c=c.then(s),g=function(t){return e.copy(t,p),u.$apply()},c.then(g)},handleFailed:function(){return console.log("PubSubResource:query>> failure received")}})),c=function(){return t.isFunction(d.get.outboundTransform)&&(i=d.get.outboundTransform(d,i)),o.publish(i,d.get.outbound)},t.isString(this.get.inbound)?g=g.then(c):c(),p},i.prototype._rpcQuery=function(r,i){var s,p,c=this;return null==r&&(r={}),null==i&&(i=!0),s=i?[]:{},t.isFunction(this.get.outboundTransform)&&(r=this.get.outboundTransform(this,r)),p=o.getResponseTo({request:r,timeout:100,outboundTopic:this.get.outbound,inboundTopic:this.get.inbound}),t.isFunction(this.get.inboundTransform)&&(p=p.then(this.get.inboundTransform)),p=p.then(function(e){return t.isArray(e)?t.map(e,function(e){return new n(e,o,c)}):new n(e,o,c)}),p.then(function(t){return e.copy(t,s),u.$apply()}),s},i.prototype.query=function(e){return null==e&&(e={}),"PUBSUB"===this.get.type?this._pubSubQuery(e,this.get.queryIsArray):this._rpcQuery(e,this.get.queryIsArray)},i.prototype.create=function(e){return new n(e,o,this)},i}()}])}),define("ngAmpjs",["ngAmpjsModule","p/shortBus","r/AmpResource"],function(e){return e}),define(["ngAmpjs"],function(e){return e})}();